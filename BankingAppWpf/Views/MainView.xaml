<Window x:Class="BankingAppWpf.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BankingAppWpf.Views"
        xmlns:vm="clr-namespace:BankingAppWpf.ViewModels"
        xmlns:converters="clr-namespace:BankingAppWpf.Helper.Converters"
        mc:Ignorable="d"
        Title="Bank Application"
        Height="450"
        Width="800">
    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <DockPanel LastChildFill="True">

        <!-- Menu -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="File">
                <MenuItem Header="Refresh"
                          Command="{Binding RefreshDataCommand}" />
                <Separator />
                <MenuItem Header="Exit"
                          Click="MenuExit_Click" />
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="About" Click="MenuAbout_Click" />
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top"
                 Margin="0,0,0,5">
            <Button Content="🔄 Refresh"
                    Command="{Binding RefreshDataCommand}"
                    ToolTip="Refresh data" />
            <Separator />
            <Button Content="➕ Customer"
                    Command="{Binding AddCustomerCommand}"
                    ToolTip="Add new customer" />
            <Button Content="➕ Account"
                    Command="{Binding AddAccountCommand}"
                    ToolTip="Add new account" />
            <Button Content="➕ Transaction"
                    Command="{Binding AddTransactionCommand}"
                    ToolTip="Add new transaction" />
        </ToolBar>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom"
                   Background="LightGray">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}"
                           FontWeight="SemiBold" />
            </StatusBarItem>
            <StatusBarItem>
                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="Current Balance:" />
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding CurrentBalance, StringFormat={}{0:C}}"
                           FontWeight="Bold"
                           Margin="5,0,0,0"
                           Foreground="{Binding CurrentBalance, Converter={x:Static converters:BalanceToColorConverter.Instance}}" />
            </StatusBarItem>
        </StatusBar>

        <!-- Main Content -->
        <TabControl>
            <!-- Customer Management Tab -->
            <TabItem Header="👥 Customer Management">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Customer Buttons -->
                    <StackPanel Grid.Row="0"
                                Orientation="Horizontal"
                                Margin="5">
                        <Button Content="New Customer"
                                Command="{Binding AddCustomerCommand}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FF008000"
                                Foreground="White" />
                        <Button Content="Edit"
                                Command="{Binding EditCustomerCommand}"
                                CommandParameter="{Binding SelectedCustomer}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FF1E90FF"
                                Foreground="White" />
                        <Button Content="Delete"
                                Command="{Binding DeleteCustomerCommand}"
                                CommandParameter="{Binding SelectedCustomer}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FFDC143C"
                                Foreground="White" />
                    </StackPanel>

                    <!-- Customer DataGrid -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding Customers}"
                              SelectedItem="{Binding SelectedCustomer}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              Margin="5">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Customer ID"
                                                Binding="{Binding CustomerId}"
                                                Width="80" />
                            <DataGridTextColumn Header="First Name"
                                                Binding="{Binding FirstName}"
                                                Width="120" />
                            <DataGridTextColumn Header="Last Name"
                                                Binding="{Binding LastName}"
                                                Width="120" />
                            <DataGridTextColumn Header="Street"
                                                Binding="{Binding Street}"
                                                Width="150" />
                            <DataGridTextColumn Header="House No."
                                                Binding="{Binding HouseNumber}"
                                                Width="80" />
                            <DataGridTextColumn Header="ZIP Code"
                                                Binding="{Binding PostalCode}"
                                                Width="70" />
                            <DataGridTextColumn Header="City"
                                                Binding="{Binding City}"
                                                Width="120" />
                            <DataGridTextColumn Header="Phone"
                                                Binding="{Binding Phone}"
                                                Width="120" />
                            <DataGridTextColumn Header="Email"
                                                Binding="{Binding Email}"
                                                Width="200" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Account Management Tab -->
            <TabItem Header="💳 Account Management">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Account Buttons -->
                    <StackPanel Grid.Row="0"
                                Orientation="Horizontal"
                                Margin="5">
                        <Button Content="New Account"
                                Command="{Binding AddAccountCommand}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FF008000"
                                Foreground="White" />
                        <Button Content="Edit"
                                Command="{Binding EditAccountCommand}"
                                CommandParameter="{Binding SelectedAccount}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FF1E90FF"
                                Foreground="White" />
                        <Button Content="Delete"
                                Command="{Binding DeleteAccountCommand}"
                                CommandParameter="{Binding SelectedAccount}"
                                Margin="5"
                                Padding="15,5"
                                Background="#FFDC143C"
                                Foreground="White" />
                    </StackPanel>

                    <!-- Accounts DataGrid -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding Accounts}"
                              SelectedItem="{Binding SelectedAccount}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              Margin="5">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Account ID"
                                                Binding="{Binding AccountId}"
                                                Width="80" />
                            <DataGridTextColumn Header="Account Number"
                                                Binding="{Binding AccountNumber}"
                                                Width="120" />
                            <DataGridTextColumn Header="Customer"
                                                Binding="{Binding Customer.FullName}"
                                                Width="200" />
                            <DataGridTextColumn Header="Start Balance"
                                                Binding="{Binding StartBalance, StringFormat={}{0:C}}"
                                                Width="100" />
                            <DataGridTextColumn Header="Current Balance"
                                                Binding="{Binding CurrentBalance, StringFormat={}{0:C}}"
                                                Width="120" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Transactions Tab -->
            <TabItem Header="📊 Transactions"
                     IsEnabled="{Binding SelectedAccount, Converter={x:Static converters:NullToBoolConverter.Instance}}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Transaction Info and Buttons -->
                    <Grid Grid.Row="0"
                          Margin="5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!-- Selected Account Info -->
                        <TextBlock Grid.Column="0"
                                   Text="{Binding SelectedAccount.DisplayInfo, StringFormat='Selected Account: {0}'}"
                                   VerticalAlignment="Center"
                                   FontWeight="Bold"
                                   Margin="0,0,10,0" />

                        <!-- Balance Display -->
                        <TextBlock Grid.Column="1"
                                   Text="{Binding CurrentBalance, StringFormat='Current Balance: {0:C}'}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   FontWeight="Bold"
                                   FontSize="14" />

                        <!-- Transaction Buttons -->
                        <StackPanel Grid.Column="2"
                                    Orientation="Horizontal">
                            <Button Content="New Transaction"
                                    Command="{Binding AddTransactionCommand}"
                                    Margin="5,0"
                                    Padding="15,5"
                                    Background="#FF008000"
                                    Foreground="White" />
                            <Button Content="Edit"
                                    Command="{Binding EditTransactionCommand}"
                                    CommandParameter="{Binding SelectedTransaction}"
                                    Margin="5,0"
                                    Padding="15,5"
                                    Background="#FF1E90FF"
                                    Foreground="White" />
                            <Button Content="Delete"
                                    Command="{Binding DeleteTransactionCommand}"
                                    CommandParameter="{Binding SelectedTransaction}"
                                    Margin="5,0"
                                    Padding="15,5"
                                    Background="#FFDC143C"
                                    Foreground="White" />
                        </StackPanel>
                    </Grid>

                    <!-- Transactions DataGrid -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding Transactions}"
                              SelectedItem="{Binding SelectedTransaction}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              Margin="5">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Date"
                                                Binding="{Binding Date, StringFormat={}{0:dd.MM.yyyy}}"
                                                Width="90" />
                            <DataGridTextColumn Header="Amount"
                                                Binding="{Binding Amount, StringFormat={}{0:C}}"
                                                Width="100" />
                            <DataGridTextColumn Header="Type"
                                                Binding="{Binding DisplayType}"
                                                Width="100" />
                            <DataGridTextColumn Header="Purpose"
                                                Binding="{Binding Purpose}"
                                                Width="200" />
                            <DataGridTextColumn Header="IBAN"
                                                Binding="{Binding IBAN}"
                                                Width="150" />
                            <DataGridTextColumn Header="Transaction No."
                                                Binding="{Binding TransactionNumber}"
                                                Width="120" />
                            <DataGridCheckBoxColumn Header="Active"
                                                    Binding="{Binding IsActive}"
                                                    Width="60" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>